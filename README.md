# Suzaku
Project optimization tool with Rust.

## Features and Roadmap
 - [ ] source code scan
 - [ ] architecture analysis
 - [ ] refactor
 - [ ] unit testing generation 
 - [ ] decouple
 - [ ] injection
 - [ ] multiple and mixing languages support

## Usages
### all usages
```shell
Usage: suzaku-cli [OPTIONS] [COMMAND]

Commands:
  parse     parse source code
  analysis  analysis source code
  help      Print this message or the help of the given subcommand(s)

Options:
  -c, --config <FILE>  Sets a custom config file
  -h, --help           Print help
  -V, --version        Print version
```
### for parsing
```shell
$ suzaku-cli parse -h
```
the usages
```shell
parse source code

Usage: suzaku-cli parse [OPTIONS]

Options:
  -s, --src <SRC>        Sets source code folder path which will be parsed [default: .]
  -o, --output <OUTPUT>  Set output folder path which will store the output files [default: .]
  -h, --help             Print help
```

### for analysing
```shell
$ suzaku-cli analysis -h
```
the usages
```shell
analysis source code

Usage: suzaku-cli analysis [OPTIONS]

Options:
  -s, --src <SRC>            Sets source code folder path which will be analyzed
  -m, --metadata <METADATA>  Sets metadata file folder path which is generated by 'Parse' command
  -o, --output <OUTPUT>      Set output folder path which will store the output files [default: .]
  -h, --help                 Print help
```

## Dependencies
### ANTLR tool

#### Requirements
- Java SE
    - [Java SE 11 Archive Downloads](https://www.oracle.com/jp/java/technologies/javase/jdk11-archive-downloads.html)
    - [Java SE 17 / 19 Downloads](https://www.oracle.com/java/technologies/downloads/)
- Maven
    - [Downloading Apache Maven](https://maven.apache.org/download.cgi)

#### Build
```shell
$ git clone -b rust-target git@github.com:rrevenantt/antlr4.git
$ cd antlr4
$ git submodule update --init --recursive --remote
```

** if you build it on macOS, there are some linked files may not be found. you need to run following command to replace the symbolic links with real files **
```shell
$ cp runtime/Rust/templates/Rust.stg tool/resources/org/antlr/v4/tool/templates/codegen/Rust/Rust.stg
$ cp runtime/Rust/templates/Rust.test.stg runtime-testsuite/resources/org/antlr/v4/test/runtime/templates/Rust.test.stg
$ cp runtime/Rust/templates/BaseRustTest.java runtime-testsuite/test/org/antlr/v4/test/runtime/rust/BaseRustTest.java
```

then, run following command to build and install tool
```shell
$ mvn -DskipTests install
```
when succeed, the jars will be installed to
```shell
$HOME/.m2/repository/org/antlr/antlr4
```

#### Generates Lexer and Parser
##### Lexer
```shell
$ java -jar $HOME/.m2/repository/org/antlr/antlr4/4.8-2-SNAPSHOT/antlr4-4.8-2-SNAPSHOT-complete.jar -Dlanguage=Rust ./language-extensions/src/java/generated/JavaLexer.g4
```

##### Parser
```shell
$ java -jar $HOME/.m2/repository/org/antlr/antlr4/4.8-2-SNAPSHOT/antlr4-4.8-2-SNAPSHOT-complete.jar -Dlanguage=Rust ./language-extensions/src/java/generated/JavaParser.g4
```
